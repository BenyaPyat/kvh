<title>kvh_driver: kvh_driver_node.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">kvh_driver_node.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="kvh__driver__node_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a>00008 <span class="comment">/*</span>
<a name="l00009"></a>00009 <span class="comment"> * LICENSE FILE</span>
<a name="l00010"></a>00010 <span class="comment"> */</span>
<a name="l00011"></a>00011 <span class="comment">//******************* SYSTEM DEPENDANCIES ****************//</span>
<a name="l00012"></a>00012 <span class="comment">//******************* LOCAL DEPENDANCIES ****************//</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include&lt;<a class="code" href="kvh__driver__node_8h.html" title="//TODO fill in detailed discription here">kvh_driver/kvh_driver_node.h</a>&gt;</span>
<a name="l00014"></a>00014 <span class="comment">//*********************** NAMESPACES ********************//</span>
<a name="l00015"></a>00015 <span class="keyword">using namespace </span>kvh_driver;
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="comment">/*</span>
<a name="l00018"></a>00018 <span class="comment">void testCallback(kvh_driver::KVHDriverConfig&amp; config, uint32_t levels)</span>
<a name="l00019"></a>00019 <span class="comment">{</span>
<a name="l00020"></a>00020 <span class="comment">        ROS_INFO_STREAM(&quot;Reconfigure Request: &quot;&lt;&lt;config.device_address&lt;&lt;config.filter&lt;&lt;config.output_topic&lt;&lt;config.poll_rate&lt;&lt;config.update_frequency);</span>
<a name="l00021"></a>00021 <span class="comment">}</span>
<a name="l00022"></a>00022 <span class="comment"> */</span>
<a name="l00023"></a>00023 
<a name="l00024"></a><a class="code" href="classkvh__driver_1_1KVHDriverNode.html#aa1237f5ac6865c88b69f4d49bd5ec024">00024</a> <a class="code" href="classkvh__driver_1_1KVHDriverNode.html#aa1237f5ac6865c88b69f4d49bd5ec024">KVHDriverNode::KVHDriverNode</a>(ros::NodeHandle&amp; nh):
<a name="l00025"></a>00025                                 imu_filter_(NULL),
<a name="l00026"></a>00026                                 odo_filter_(NULL),
<a name="l00027"></a>00027                                 nh_(nh)
<a name="l00028"></a>00028 {
<a name="l00029"></a>00029 
<a name="l00030"></a>00030         <span class="comment">//Register the Dynamic Reconfigure Server</span>
<a name="l00031"></a>00031         dynamic_reconfigure::Server&lt;KVHDriverConfig&gt;::CallbackType cb;
<a name="l00032"></a>00032         cb = boost::bind(&amp;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ab63dcc2f2cc2e5f2116e9009f4aabdde">KVHDriverNode::dynamic_reconfigureCB</a>, <span class="keyword">this</span>, _1, _2);
<a name="l00033"></a>00033         this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#af3d5caf127d2491d59ac17c3bdc93f27">dr_server_</a>.setCallback(cb);
<a name="l00034"></a>00034 
<a name="l00035"></a>00035         <span class="comment">//Build the filters</span>
<a name="l00036"></a>00036         ROS_INFO(<span class="stringliteral">&quot;Building Filters....&quot;</span>);
<a name="l00037"></a>00037         <span class="comment">//TODO actually get the system/measurement noise/covar from nh_</span>
<a name="l00038"></a>00038         ColumnVector system_noise(<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>());
<a name="l00039"></a>00039         system_noise   = 0;
<a name="l00040"></a>00040         SymmetricMatrix system_sigma_noise(<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>());
<a name="l00041"></a>00041         system_sigma_noise = 0;
<a name="l00042"></a>00042         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 1; r &lt;= <a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>(); ++r)
<a name="l00043"></a>00043         {
<a name="l00044"></a>00044                 system_sigma_noise(r,r) = 100;
<a name="l00045"></a>00045         }
<a name="l00046"></a>00046 
<a name="l00047"></a>00047         ColumnVector measurement_noise(<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>());
<a name="l00048"></a>00048         measurement_noise   = 0;
<a name="l00049"></a>00049         SymmetricMatrix measurement_sigma_noise(<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>());
<a name="l00050"></a>00050         measurement_sigma_noise = 0;
<a name="l00051"></a>00051         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 1; r &lt;= <a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>(); ++r)
<a name="l00052"></a>00052         {
<a name="l00053"></a>00053                 system_sigma_noise(r,r) = 0.1;
<a name="l00054"></a>00054         }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056         ROS_INFO(<span class="stringliteral">&quot;IMU Filter noise matrices built...&quot;</span>);
<a name="l00057"></a>00057 
<a name="l00058"></a>00058         this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad3a224735ff51b01274daa0ff6a29696">imu_filter_</a> = <span class="keyword">new</span> <a class="code" href="classkvh__driver_1_1IMUFilter.html">IMUFilter</a>(system_noise, system_sigma_noise, measurement_noise, measurement_sigma_noise);
<a name="l00059"></a>00059 
<a name="l00060"></a>00060         <span class="comment">//TODO Actually get the initial state estimate/covar from nh_</span>
<a name="l00061"></a>00061         ColumnVector initial_state_estimate(<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>());
<a name="l00062"></a>00062         initial_state_estimate   = 0;
<a name="l00063"></a>00063         SymmetricMatrix initial_state_covariance(<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>());
<a name="l00064"></a>00064         initial_state_covariance = 0;
<a name="l00065"></a>00065         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 1; r &lt;= <a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>(); ++r)
<a name="l00066"></a>00066         {
<a name="l00067"></a>00067                 initial_state_covariance(r,r) = 1;
<a name="l00068"></a>00068         }
<a name="l00069"></a>00069 
<a name="l00070"></a>00070         this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad3a224735ff51b01274daa0ff6a29696">imu_filter_</a>-&gt;<a class="code" href="classkvh__driver_1_1LinearFilter.html#a5ab8cff7005b7507c6589822c3424bc0" title="Initializes the filter to an initial state estimate and covariance.">init</a>(initial_state_estimate, initial_state_covariance);
<a name="l00071"></a>00071 
<a name="l00072"></a>00072         <span class="comment">//TODO Build the odo_filter if that is requested</span>
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 
<a name="l00075"></a>00075         ROS_INFO(<span class="stringliteral">&quot;Setting up Publishers....&quot;</span>);
<a name="l00076"></a>00076         <span class="comment">//Set up the publisher</span>
<a name="l00077"></a>00077         <span class="comment">//TODO actually get the output topic from nh_</span>
<a name="l00078"></a>00078         std::string imu_topic(<span class="stringliteral">&quot;kvh/imu&quot;</span>);
<a name="l00079"></a>00079         this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ae863e7d5ffd48d603fbdabd7dd38a785">imu_pub_</a> = this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#a32b6d62552cbaf9b58711080b5cffc87">nh_</a>.advertise&lt;sensor_msgs::Imu&gt;(imu_topic, 2);
<a name="l00080"></a>00080 
<a name="l00081"></a>00081         ROS_INFO(<span class="stringliteral">&quot;Registering Update Timer....&quot;</span>);
<a name="l00082"></a>00082         <span class="comment">//Set up the update timer</span>
<a name="l00083"></a>00083         this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#a0e518ab9f446d6850c9305602e36cfde">update_frequency_</a> = ros::Duration(1.0/100.0); <span class="comment">//TODO actually get this parameter from nh_</span>
<a name="l00084"></a>00084         this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ade628598424122057bfac93a30011bea">update_timer_</a> = this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#a32b6d62552cbaf9b58711080b5cffc87">nh_</a>.createTimer(this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#a0e518ab9f446d6850c9305602e36cfde">update_frequency_</a>, &amp;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad1ff4c080574ac985439e5063715368b">KVHDriverNode::update</a>, <span class="keyword">this</span>);
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 }
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad06a278d61fffb92784943fa98130fb6">00088</a> <a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad06a278d61fffb92784943fa98130fb6">KVHDriverNode::~KVHDriverNode</a>()
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090         <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad3a224735ff51b01274daa0ff6a29696">imu_filter_</a>!=NULL) <span class="keyword">delete</span> <a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad3a224735ff51b01274daa0ff6a29696">imu_filter_</a>;
<a name="l00091"></a>00091         <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#a92545a2056881b360f02485cc1d3d999">odo_filter_</a>!=NULL) <span class="keyword">delete</span> <a class="code" href="classkvh__driver_1_1KVHDriverNode.html#a92545a2056881b360f02485cc1d3d999">odo_filter_</a>;
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad1ff4c080574ac985439e5063715368b">00094</a> <span class="keywordtype">void</span> <a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad1ff4c080574ac985439e5063715368b">KVHDriverNode::update</a>(<span class="keyword">const</span> ros::TimerEvent&amp; event)
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096         ROS_INFO(<span class="stringliteral">&quot;I&#39;m Performing a Update!&quot;</span>);
<a name="l00097"></a>00097         <span class="comment">//TODO alternate what happens based on if IMU, Odom or both/none are being filtered</span>
<a name="l00098"></a>00098         <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad3a224735ff51b01274daa0ff6a29696">imu_filter_</a>-&gt;<a class="code" href="classkvh__driver_1_1LinearFilter.html#ab2ae4613ac40a83d1149ca60e47c9157">isInitialized</a>())
<a name="l00099"></a>00099         {
<a name="l00100"></a>00100                 ColumnVector input(0);
<a name="l00101"></a>00101                 input       = 0;
<a name="l00102"></a>00102                 ColumnVector measurement(<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>());
<a name="l00103"></a>00103                 measurement = 0;
<a name="l00104"></a>00104                 <span class="comment">//TODO actually generate real input from sensor</span>
<a name="l00105"></a>00105                 this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad3a224735ff51b01274daa0ff6a29696">imu_filter_</a>-&gt;<a class="code" href="classkvh__driver_1_1LinearFilter.html#a48a760b19a8da9dadf5bbb9a3775a1ef" title="Updates the filter given new system input and measurement.">update</a>(input, measurement);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107                 <span class="comment">//Build and publish message</span>
<a name="l00108"></a>00108                 ColumnVector     state(<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>());
<a name="l00109"></a>00109                 SymmetricMatrix  covar(<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>(),<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>());
<a name="l00110"></a>00110                 this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ad3a224735ff51b01274daa0ff6a29696">imu_filter_</a>-&gt;<a class="code" href="classkvh__driver_1_1LinearFilter.html#aed5c638a63245e074e2490241796b4d7" title="Gets the latest state estimate from the filter.">getEstimate</a>(state, covar);
<a name="l00111"></a>00111                 sensor_msgs::Imu message;
<a name="l00112"></a>00112                 this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#aeb1fc161a8b7c6c2953b6ae8762da24b">stateToImu</a>(state, covar, message);
<a name="l00113"></a>00113                 this-&gt;<a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ae863e7d5ffd48d603fbdabd7dd38a785">imu_pub_</a>.publish(message);
<a name="l00114"></a>00114         }
<a name="l00115"></a>00115         <span class="keywordflow">else</span>
<a name="l00116"></a>00116         {
<a name="l00117"></a>00117                 ROS_ERROR(<span class="stringliteral">&quot;Cannot perform update on an uninitialized filter&quot;</span>);
<a name="l00118"></a>00118         }
<a name="l00119"></a>00119 }
<a name="l00120"></a>00120 
<a name="l00121"></a><a class="code" href="classkvh__driver_1_1KVHDriverNode.html#aeb1fc161a8b7c6c2953b6ae8762da24b">00121</a> <span class="keywordtype">bool</span> <a class="code" href="classkvh__driver_1_1KVHDriverNode.html#aeb1fc161a8b7c6c2953b6ae8762da24b">KVHDriverNode::stateToImu</a>(<span class="keyword">const</span> ColumnVector&amp; state, <span class="keyword">const</span> SymmetricMatrix&amp; covar, sensor_msgs::Imu message)<span class="keyword"> const</span>
<a name="l00122"></a>00122 <span class="keyword"></span>{
<a name="l00123"></a>00123         <span class="keywordflow">if</span>(state.size()==<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>() &amp;&amp; covar.size1()==<a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>())
<a name="l00124"></a>00124         {
<a name="l00125"></a>00125                 message.orientation_covariance[0]   = -1;
<a name="l00126"></a>00126                 message.orientation_covariance[1*3] = -1;
<a name="l00127"></a>00127                 message.orientation_covariance[2*3] = -1;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129                 message.angular_velocity.x    = state(<a class="code" href="classkvh__driver_1_1constants.html#a01a4ab749774a4ab14567181dfef902e">constants::IMU_RX_DOT_STATE</a>());
<a name="l00130"></a>00130                 message.angular_velocity.y    = state(<a class="code" href="classkvh__driver_1_1constants.html#a0e275405901e0733a6ac6674fdf869fa">constants::IMU_RY_DOT_STATE</a>());
<a name="l00131"></a>00131                 message.angular_velocity.z    = state(<a class="code" href="classkvh__driver_1_1constants.html#a26d1dc1cd5875de9f66e00ae6cc756b5">constants::IMU_RZ_DOT_STATE</a>());
<a name="l00132"></a>00132 
<a name="l00133"></a>00133                 message.angular_velocity_covariance[(<a class="code" href="classkvh__driver_1_1constants.html#a01a4ab749774a4ab14567181dfef902e">constants::IMU_RX_DOT_STATE</a>()-<a class="code" href="classkvh__driver_1_1constants.html#a01a4ab749774a4ab14567181dfef902e">constants::IMU_RX_DOT_STATE</a>())*3] = covar(<a class="code" href="classkvh__driver_1_1constants.html#a01a4ab749774a4ab14567181dfef902e">constants::IMU_RX_DOT_STATE</a>(), <a class="code" href="classkvh__driver_1_1constants.html#a01a4ab749774a4ab14567181dfef902e">constants::IMU_RX_DOT_STATE</a>());
<a name="l00134"></a>00134                 message.angular_velocity_covariance[(<a class="code" href="classkvh__driver_1_1constants.html#a0e275405901e0733a6ac6674fdf869fa">constants::IMU_RY_DOT_STATE</a>()-<a class="code" href="classkvh__driver_1_1constants.html#a01a4ab749774a4ab14567181dfef902e">constants::IMU_RX_DOT_STATE</a>())*3] = covar(<a class="code" href="classkvh__driver_1_1constants.html#a0e275405901e0733a6ac6674fdf869fa">constants::IMU_RY_DOT_STATE</a>(), <a class="code" href="classkvh__driver_1_1constants.html#a0e275405901e0733a6ac6674fdf869fa">constants::IMU_RY_DOT_STATE</a>());
<a name="l00135"></a>00135                 message.angular_velocity_covariance[(<a class="code" href="classkvh__driver_1_1constants.html#a26d1dc1cd5875de9f66e00ae6cc756b5">constants::IMU_RZ_DOT_STATE</a>()-<a class="code" href="classkvh__driver_1_1constants.html#a01a4ab749774a4ab14567181dfef902e">constants::IMU_RX_DOT_STATE</a>())*3] = covar(<a class="code" href="classkvh__driver_1_1constants.html#a26d1dc1cd5875de9f66e00ae6cc756b5">constants::IMU_RZ_DOT_STATE</a>(), <a class="code" href="classkvh__driver_1_1constants.html#a26d1dc1cd5875de9f66e00ae6cc756b5">constants::IMU_RZ_DOT_STATE</a>());
<a name="l00136"></a>00136 
<a name="l00137"></a>00137                 message.linear_acceleration.x = state(<a class="code" href="classkvh__driver_1_1constants.html#a085387ef817f7a3ab42b207265d1e766">constants::IMU_X_DOT_DOT_STATE</a>());
<a name="l00138"></a>00138                 message.linear_acceleration.y = state(<a class="code" href="classkvh__driver_1_1constants.html#a4e2c08fe8a7bd7ac53cdbe9fe70ba3ad">constants::IMU_Y_DOT_DOT_STATE</a>());
<a name="l00139"></a>00139                 message.linear_acceleration.z = state(<a class="code" href="classkvh__driver_1_1constants.html#a3a541a5cf83ddffd37610ff3495a0a8d">constants::IMU_Z_DOT_DOT_STATE</a>());
<a name="l00140"></a>00140 
<a name="l00141"></a>00141                 message.linear_acceleration_covariance[(<a class="code" href="classkvh__driver_1_1constants.html#a085387ef817f7a3ab42b207265d1e766">constants::IMU_X_DOT_DOT_STATE</a>()-<a class="code" href="classkvh__driver_1_1constants.html#a085387ef817f7a3ab42b207265d1e766">constants::IMU_X_DOT_DOT_STATE</a>())*3] = covar(<a class="code" href="classkvh__driver_1_1constants.html#a085387ef817f7a3ab42b207265d1e766">constants::IMU_X_DOT_DOT_STATE</a>(), <a class="code" href="classkvh__driver_1_1constants.html#a085387ef817f7a3ab42b207265d1e766">constants::IMU_X_DOT_DOT_STATE</a>());
<a name="l00142"></a>00142                 message.linear_acceleration_covariance[(<a class="code" href="classkvh__driver_1_1constants.html#a4e2c08fe8a7bd7ac53cdbe9fe70ba3ad">constants::IMU_Y_DOT_DOT_STATE</a>()-<a class="code" href="classkvh__driver_1_1constants.html#a085387ef817f7a3ab42b207265d1e766">constants::IMU_X_DOT_DOT_STATE</a>())*3] = covar(<a class="code" href="classkvh__driver_1_1constants.html#a4e2c08fe8a7bd7ac53cdbe9fe70ba3ad">constants::IMU_Y_DOT_DOT_STATE</a>(), <a class="code" href="classkvh__driver_1_1constants.html#a4e2c08fe8a7bd7ac53cdbe9fe70ba3ad">constants::IMU_Y_DOT_DOT_STATE</a>());
<a name="l00143"></a>00143                 message.linear_acceleration_covariance[(<a class="code" href="classkvh__driver_1_1constants.html#a3a541a5cf83ddffd37610ff3495a0a8d">constants::IMU_Z_DOT_DOT_STATE</a>()-<a class="code" href="classkvh__driver_1_1constants.html#a085387ef817f7a3ab42b207265d1e766">constants::IMU_X_DOT_DOT_STATE</a>())*3] = covar(<a class="code" href="classkvh__driver_1_1constants.html#a3a541a5cf83ddffd37610ff3495a0a8d">constants::IMU_Z_DOT_DOT_STATE</a>(), <a class="code" href="classkvh__driver_1_1constants.html#a3a541a5cf83ddffd37610ff3495a0a8d">constants::IMU_Z_DOT_DOT_STATE</a>());
<a name="l00144"></a>00144 
<a name="l00145"></a>00145                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00146"></a>00146         }
<a name="l00147"></a>00147         <span class="keywordflow">else</span>
<a name="l00148"></a>00148         {
<a name="l00149"></a>00149                 ROS_ERROR(<span class="stringliteral">&quot;Cannot Build IMU Message for State Vector Size %d, Expecting %d&quot;</span>, state.size(), <a class="code" href="classkvh__driver_1_1constants.html#acd06d3ff9725237176c0b926019898c5">constants::IMU_STATE_SIZE</a>());
<a name="l00150"></a>00150                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00151"></a>00151         }
<a name="l00152"></a>00152 }
<a name="l00153"></a>00153 
<a name="l00154"></a><a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ab57a0e2726b8124400da1ca6c7d22c36">00154</a> <span class="keywordtype">int</span> <a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ab57a0e2726b8124400da1ca6c7d22c36">KVHDriverNode::covarIndexCalc</a>(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> c)
<a name="l00155"></a>00155 {
<a name="l00156"></a>00156         <span class="keywordflow">return</span> 1;
<a name="l00157"></a>00157 }
<a name="l00158"></a>00158 
<a name="l00159"></a><a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ab63dcc2f2cc2e5f2116e9009f4aabdde">00159</a> <span class="keywordtype">void</span> <a class="code" href="classkvh__driver_1_1KVHDriverNode.html#ab63dcc2f2cc2e5f2116e9009f4aabdde">KVHDriverNode::dynamic_reconfigureCB</a>(<span class="keyword">const</span> <a class="code" href="classkvh__driver_1_1KVHDriverConfig.html">KVHDriverConfig</a>&amp; config, uint32_t <a class="code" href="namespacekvh__driver_1_1cfg_1_1KVHParamsConfig.html#a7ede073d17b319d2e6c9b972f38745df">level</a>)
<a name="l00160"></a>00160 {
<a name="l00161"></a>00161         ROS_INFO_STREAM(<span class="stringliteral">&quot;\nGot a Dynamic Reconfigure Request:&quot;</span>
<a name="l00162"></a>00162                               &lt;&lt;<span class="stringliteral">&quot;\nDevice Address: &quot;</span>&lt;&lt;config.<a class="code" href="classkvh__driver_1_1KVHDriverConfig.html#a32cd03abc9cf0c1847a1cdd5d74874f5">device_address</a>
<a name="l00163"></a>00163                               &lt;&lt;<span class="stringliteral">&quot;\nFilter: &quot;</span>        &lt;&lt;config.<a class="code" href="classkvh__driver_1_1KVHDriverConfig.html#a172e0009c37c63c33e6d335bc67b42ed">filter</a>
<a name="l00164"></a>00164                               &lt;&lt;<span class="stringliteral">&quot;\nOutput Topic:&quot;</span>   &lt;&lt;config.<a class="code" href="classkvh__driver_1_1KVHDriverConfig.html#ab1df720114413f9c51e16534255d57ff">output_topic</a>
<a name="l00165"></a>00165                               &lt;&lt;<span class="stringliteral">&quot;\nPoll Rate&quot;</span>       &lt;&lt;config.<a class="code" href="classkvh__driver_1_1KVHDriverConfig.html#ade1fa1ea89ce6baed87dbdf33e1c8c05">poll_rate</a>
<a name="l00166"></a>00166                               &lt;&lt;<span class="stringliteral">&quot;\nUpdate Frequency&quot;</span>&lt;&lt;config.<a class="code" href="classkvh__driver_1_1KVHDriverConfig.html#a6e6d66d6c2f90c952b2a600abb37cd92">update_frequency</a>);
<a name="l00167"></a>00167 }
<a name="l00168"></a>00168 
<a name="l00169"></a><a class="code" href="kvh__driver__node_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">00169</a> <span class="keywordtype">int</span> <a class="code" href="namespaceinterrogate__setup__dot__py.html#a13c37ad37b9153e698b6bed029bf5d86">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
<a name="l00170"></a>00170         ros::init(argc, argv, <span class="stringliteral">&quot;kvh_driver_node&quot;</span>);
<a name="l00171"></a>00171         ros::NodeHandle nh;
<a name="l00172"></a>00172 
<a name="l00173"></a>00173         <span class="comment">/*</span>
<a name="l00174"></a>00174 <span class="comment">        dynamic_reconfigure::Server&lt;kvh_driver::KVHDriverConfig&gt; dr_server;</span>
<a name="l00175"></a>00175 <span class="comment">        dynamic_reconfigure::Server&lt;kvh_driver::KVHDriverConfig&gt;::CallbackType cb;</span>
<a name="l00176"></a>00176 <span class="comment">        cb = boost::bind(&amp;testCallback, _1, _2);</span>
<a name="l00177"></a>00177 <span class="comment">        dr_server.setCallback(cb);</span>
<a name="l00178"></a>00178 <span class="comment">        ROS_INFO(&quot;Dynamic Reconfigure Bindings Active&quot;);</span>
<a name="l00179"></a>00179 <span class="comment">         */</span>
<a name="l00180"></a>00180 
<a name="l00181"></a>00181         ROS_INFO(<span class="stringliteral">&quot;Setting up the driver...&quot;</span>);
<a name="l00182"></a>00182 
<a name="l00183"></a>00183         <a class="code" href="classkvh__driver_1_1KVHDriverNode.html">KVHDriverNode</a> node(nh);
<a name="l00184"></a>00184 
<a name="l00185"></a>00185         ROS_INFO(<span class="stringliteral">&quot;kvh_driver_node &lt;%s&gt; up and running&quot;</span>, nh.getNamespace().c_str());
<a name="l00186"></a>00186         ros::spin();
<a name="l00187"></a>00187         <span class="keywordflow">return</span> 1;
<a name="l00188"></a>00188 }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://ros.org/wiki/kvh_driver">kvh_driver</a><br />
Author(s): Adam Panzica</br />
<small>autogenerated on Sun Feb 10 2013 18:53:12</small>
</div>
</body>
</html>
